<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AfroLingua - Onboarding 3</title>
    <link rel="stylesheet" href="/onboarding/styling/onboarding3.css" />
  </head>
  <body>
    <header>
      <nav>
        <h1 class="logo">AfroLingua</h1>
      </nav>
    </header>

    <main>
      <section class="onboarding-section">
        <h1 id="mainText">How much <span id="selectedLanguage"></span> do you know?</h1>
        <p class="subtext" id="subtext">Start your personalised <span id="selectedLanguageSub"></span> journey</p>

        <!-- Proficiency Containers -->
        <div class="grid-container">
          <div class="proficiency-container" data-value="beginner">
            <span class="proficiency-text">I'm a complete beginner</span>
            <span class="proficiency-subtext">Start from scratch</span>
          </div>
          <div class="proficiency-container" data-value="intermediate">
            <span class="proficiency-text">I know some <span id="selectedLanguageBody"></span></span>
            <span class="proficiency-subtext">Find your level</span>
          </div>
        </div>
      </section>
    </main>

    <!-- Footer -->
    <footer>
      <button id="nextButton" disabled>Next</button>
    </footer>

    <script>
      // Get the selected language, goal, and flag from the URL parameters
      const urlParams = new URLSearchParams(window.location.search);
      const selectedLanguage = urlParams.get("language");
      const selectedGoal = urlParams.get("goal");
      const selectedFlag = urlParams.get("flag");
    
      console.log("Selected Language (Onboarding 3):", selectedLanguage); // Debugging
      console.log("Selected Goal (Onboarding 3):", selectedGoal); // Debugging
      console.log("Selected Flag (Onboarding 3):", selectedFlag); // Debugging
    
      // Update the main text, subtext, and body with the selected language
      const selectedLanguageElement = document.getElementById("selectedLanguage");
      const selectedLanguageSubElement = document.getElementById("selectedLanguageSub");
      const selectedLanguageBodyElement = document.getElementById("selectedLanguageBody");
    
      if (selectedLanguage) {
        selectedLanguageElement.textContent = selectedLanguage;
        selectedLanguageSubElement.textContent = selectedLanguage;
        selectedLanguageBodyElement.textContent = selectedLanguage;
    
        // Apply gradient to the selected language in the main text only
        selectedLanguageElement.style.background = "linear-gradient(to right, #000000, #ffd700)";
        selectedLanguageElement.style.webkitBackgroundClip = "text";
        selectedLanguageElement.style.webkitTextFillColor = "transparent";
      } else {
        selectedLanguageElement.textContent = "this language";
        selectedLanguageSubElement.textContent = "this language";
        selectedLanguageBodyElement.textContent = "this language";
      }
    
      // Proficiency Containers Logic
      const proficiencyContainers = document.querySelectorAll(".proficiency-container");
      const nextButton = document.getElementById("nextButton");
    
      proficiencyContainers.forEach((container) => {
        container.addEventListener("click", () => {
          // Deselect all containers
          proficiencyContainers.forEach((c) => c.classList.remove("selected"));
          // Select the clicked container
          container.classList.add("selected");
          console.log("Selected:", container.dataset.value); // Debugging
    
          // Enable the Next button
          nextButton.disabled = false;
        });
      });
    
      // Next Button Logic
      nextButton.addEventListener("click", () => {
        const selectedContainer = document.querySelector(".proficiency-container.selected");
        if (selectedContainer) {
          console.log("Proceeding with:", selectedContainer.dataset.value); // Debugging
          // Save the selected proficiency level to localStorage
          localStorage.setItem("selectedProficiency", selectedContainer.dataset.value);
    
          // Redirect based on the selected proficiency level
          if (selectedContainer.dataset.value === "beginner") {
            window.location.href = `../screens/home.html?language=${selectedLanguage}&flag=${selectedFlag}`; // Redirect to home.html for beginners
          } else {
            window.location.href = `onboarding4.html?language=${selectedLanguage}&flag=${selectedFlag}`; // Redirect to onboarding4.html for intermediate users
          }
        }
      });
    </script>
  </body>
</html>